<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Artesanos de PATAC México | Las Manos Detrás del Arte Textil</title>
    <meta name="description"
        content="Conoce a los artesanos indígenas que preservan el patrimonio textil de México. Historias reales, técnicas ancestrales, y el impacto transformador de PATAC en sus comunidades.">
    <meta name="keywords"
        content="artesanos mexicanos, textiles indígenas, patrimonio cultural, artesanía originaria, comunidades indígenas México, tejedores tradicionales">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://patac.org/artesanos.html">
    <meta property="og:title" content="Artesanos de PATAC México | Las Manos Detrás del Arte">
    <meta property="og:description"
        content="Conoce las historias de los artesanos indígenas que preservan técnicas textiles ancestrales. Cada hilo cuenta una historia de resistencia y cultura viva.">
    <meta property="og:image" content="https://patac.org/og-artesanos.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://patac.org/artesanos.html">
    <meta property="twitter:title" content="Artesanos de PATAC México">
    <meta property="twitter:description"
        content="Historias reales de artesanos que tejen el patrimonio cultural de México.">
    <meta property="twitter:image" content="https://patac.org/twitter-artesanos.jpg">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

    <!-- Prefetch de páginas críticas -->
    <link rel="prefetch" href="proyectos.html">
    <link rel="prefetch" href="voluntariado.html">
    <link rel="prefetch" href="index.html">

    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- AOS Animations -->
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />

    <!-- Typed.js for typewriter effect -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="styles.css">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://patac.org/artesanos.html">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CollectionPage",
      "name": "Artesanos de PATAC México",
      "description": "Perfiles de artesanos indígenas que preservan técnicas textiles ancestrales con el apoyo de PATAC México",
      "provider": {
        "@type": "Organization",
        "name": "PATAC México"
      }
    }
    </script>

    <style>
        /* Estilos específicos solo para funcionalidades únicas de esta página */

        /* Hero con video de fondo y máquina de escribir */
        .artesanos-hero {
            position: relative;
            min-height: 85vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding-right: 60px; /* Espacio para quick nav */
        }

        .hero-video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            filter: brightness(0.7);
        }

        .hero-content-enhanced {
            position: relative;
            z-index: 2;
            max-width: 900px;
            padding: 2rem;
            text-align: center;
        }

        .typewriter-container {
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 2rem 0;
        }

        .typewriter-text {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--white);
            text-shadow: 2px 4px 8px rgba(0, 0, 0, 0.5);
            line-height: 1.2;
        }

        /* Filtros mejorados - solo sticky en desktop */
        .filters-container {
            background: var(--white);
            padding: 2rem 0;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            padding-right: 60px; /* Espacio para quick nav */
        }

        .filters-container.sticky-desktop {
            position: sticky;
            top: 80px;
            z-index: var(--z-sticky);
            box-shadow: var(--shadow-md);
        }

        /* Grid de artesanos */
        .artesanos-masonry {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            padding: 2rem 0;
            padding-right: 60px; /* Espacio para quick nav */
        }

        /* Avatar con borde animado */
        .artesano-avatar-cultural {
            position: relative;
            width: 180px;
            height: 180px;
            margin: 0 auto 1.5rem;
        }

        .artesano-avatar-cultural::before {
            content: '';
            position: absolute;
            inset: -8px;
            background: linear-gradient(135deg, var(--gold), var(--accent));
            border-radius: 50%;
            z-index: -1;
            animation: rotate-border 3s linear infinite;
        }

        @keyframes rotate-border {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .artesano-avatar-cultural img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid var(--white);
        }

        /* Modal mejorado */
        .modal-content-enhanced {
            background: var(--white);
            max-width: var(--max-width-4xl);
            width: 95%;
            max-height: 90vh;
            border-radius: var(--radius-3xl);
            overflow: hidden;
            position: relative;
            z-index: calc(var(--z-modal) + 1);
            animation: slideUp var(--transition-bounce);
            box-shadow: var(--shadow-2xl);
            display: flex;
            flex-direction: column;
        }

        .modal-body-scrollable {
            overflow-y: auto;
            max-height: calc(90vh - 120px);
            padding: 2rem;
        }

        .modal-close-enhanced {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 48px;
            height: 48px;
            background: var(--white);
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 10;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }

        .modal-close-enhanced:hover {
            background: var(--accent);
            color: var(--white);
            transform: rotate(90deg);
        }

        /* Video responsive en modal */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: var(--radius-lg);
            margin: 1.5rem 0;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Quick Navigation */
        .quick-nav-artesanos {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 15px 10px;
        }

        .quick-nav-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        .quick-nav-link:hover,
        .quick-nav-link.active {
            background-color: var(--gold);
            transform: scale(1.1);
        }

        .quick-nav-tooltip {
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            background-color: var(--dark);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .quick-nav-link:hover .quick-nav-tooltip,
        .quick-nav-link:focus .quick-nav-tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .artesanos-hero {
                padding-right: 40px;
            }
            
            .typewriter-text {
                font-size: 1.8rem;
            }

            .filters-container.sticky-desktop {
                position: static;
                top: auto;
                box-shadow: none;
            }

            .filters-container {
                padding-right: 40px;
            }

            .artesanos-masonry {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding-right: 40px;
            }

            .modal-content-enhanced {
                width: 100%;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }

            .modal-body-scrollable {
                max-height: calc(100vh - 120px);
                padding: 1.5rem;
            }

            .quick-nav-artesanos {
                right: 8px;
                padding: 10px 6px;
            }

            .quick-nav-link {
                width: 28px;
                height: 28px;
            }

            .quick-nav-tooltip {
                font-size: 0.7rem;
                right: 40px;
            }
        }

        @media (max-width: 480px) {
            .typewriter-text {
                font-size: 1.5rem;
            }

            .hero-content-enhanced {
                padding: 1rem;
            }
        }

        /* Clases de utilidad */
        .hidden-desktop {
            display: none;
        }

        @media (max-width: 768px) {
            .hidden-desktop {
                display: block;
            }
        }

        .tecnica-badge {
            display: inline-block;
            background: var(--primary-light);
            color: var(--primary);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            margin: 0.25rem;
        }

        .impact-metrics {
            display: flex;
            justify-content: space-around;
            margin: 1.5rem 0;
            text-align: center;
        }

        .metric-item {
            flex: 1;
        }

        .metric-value {
            display: block;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--gold);
        }

        .metric-label {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .historia-destacada {
            background: var(--light);
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--gold);
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="nav" id="main-nav">
        <div class="nav-content">
            <a href="index.html" class="nav-logo" aria-label="PATAC México - Inicio">PATAC</a>
            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="index.html#mision">Misión</a></li>
                <li><a href="proyectos.html">Proyectos</a></li>
                <li><a href="artesanos.html" class="active" aria-current="page">Artesanos</a></li>
                <li><a href="voluntariado.html">Voluntariado</a></li>
                <li><a href="transparencia.html">Transparencia</a></li>
                <li><a href="nosotros.html">Nosotros</a></li>
            </ul>
            <button class="nav-toggle" id="nav-toggle" aria-label="Abrir menú móvil" aria-expanded="false">
                <span></span><span></span><span></span>
            </button>
        </div>
    </nav>

    <!-- Sidebar Navigation -->
    <aside class="nav-sidebar" id="nav-sidebar" aria-label="Menú móvil">
        <div class="nav-sidebar-header">
            <span class="nav-sidebar-logo">PATAC</span>
            <button class="nav-sidebar-close" id="nav-close" aria-label="Cerrar menú" aria-expanded="false">&times;</button>
        </div>
        <ul class="nav-sidebar-links">
            <li><a href="index.html">Inicio</a></li>
            <li><a href="index.html#mision">Misión</a></li>
            <li><a href="proyectos.html">Proyectos</a></li>
            <li><a href="artesanos.html" aria-current="page">Artesanos</a></li>
            <li><a href="voluntariado.html">Voluntariado</a></li>
            <li><a href="transparencia.html">Transparencia</a></li>
            <li><a href="nosotros.html">Nosotros</a></li>
        </ul>
    </aside>
    <div class="nav-overlay" id="nav-overlay"></div>

    <!-- Quick Navigation -->
    <aside class="quick-nav-artesanos" role="navigation" aria-label="Navegación rápida artesanos">
        <ul class="quick-nav-list">
            <li class="quick-nav-item"><a href="#artesanos-grid-section" class="quick-nav-link active" aria-label="Galería de artesanos"><span class="quick-nav-tooltip">Galería</span></a></li>
            <li class="quick-nav-item"><a href="#historias-impacto" class="quick-nav-link" aria-label="Historias de impacto"><span class="quick-nav-tooltip">Historias</span></a></li>
            <li class="quick-nav-item"><a href="#cta-final" class="quick-nav-link" aria-label="Apoyar"><span class="quick-nav-tooltip">Apoyar</span></a></li>
        </ul>
    </aside>

    <!-- Hero Section con Video y Máquina de Escribir -->
    <section class="artesanos-hero hero" id="hero-artesanos">
        <video class="hero-video-background" autoplay muted loop playsinline>
            <source src="https://www.pexels.com/es-es/download/video/7399316/" type="video/mp4">
            <img src="https://images.unsplash.com/photo-1609137144813-7d9921338f24?q=80&w=2000"
                alt="Artesanos trabajando" loading="lazy">
        </video>
        <div class="hero-overlay"></div>
        <div class="hero-content-enhanced" data-aos="fade-up">
            <div class="hero-badge">EL CORAZÓN DE PATAC MÉXICO</div>
            <h1 class="proyectos-hero-title">Las Manos Detrás del Arte</h1>

            <!-- Máquina de escribir -->
            <div class="typewriter-container">
                <div class="typewriter-text" id="typewriter" aria-live="polite"></div>
            </div>

            <p class="hero-description">
                Cada hilo es una historia. Cada tejido es resistencia cultural. Conoce a los custodios de técnicas
                ancestrales que, con el apoyo de PATAC, transforman tradiciones milenarias en sustento digno y orgullo
                comunitario.
            </p>

            <!-- Stats Hero -->
            <div class="hero-stats-cultural">
                <div class="hero-stat-cultural" data-aos="zoom-in" data-aos-delay="200">
                    <i class="fas fa-users hero-stat-icon" aria-hidden="true"></i>
                    <span class="hero-stat-number" id="total-artesanos">500+</span>
                    <span class="hero-stat-label">Artesanos Apoyados</span>
                </div>
                <div class="hero-stat-cultural" data-aos="zoom-in" data-aos-delay="300">
                    <i class="fas fa-map-marker-alt hero-stat-icon" aria-hidden="true"></i>
                    <span class="hero-stat-number" id="total-comunidades">50+</span>
                    <span class="hero-stat-label">Comunidades</span>
                </div>
                <div class="hero-stat-cultural" data-aos="zoom-in" data-aos-delay="400">
                    <i class="fas fa-language hero-stat-icon" aria-hidden="true"></i>
                    <span class="hero-stat-number" id="total-lenguas">15+</span>
                    <span class="hero-stat-label">Lenguas Originarias</span>
                </div>
                <div class="hero-stat-cultural" data-aos="zoom-in" data-aos-delay="500">
                    <i class="fas fa-chart-line hero-stat-icon" aria-hidden="true"></i>
                    <span class="hero-stat-number">+300%</span>
                    <span class="hero-stat-label">Incremento Promedio</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Botón para mostrar filtros en móvil -->
    <div class="container hidden-desktop" style="padding: 1rem;">
        <button class="btn btn-primary btn-sm" id="toggle-filters-mobile" style="width: 100%;">
            <i class="fas fa-filter mr-2" aria-hidden="true"></i> Mostrar Filtros
        </button>
    </div>

    <!-- Filtros - Solo sticky en desktop -->
    <div class="filters-container sticky-desktop" id="filters-container" role="search" aria-label="Filtros de artesanos">
        <div class="container">
            <div class="filter-bar">
                <div class="filter-group">
                    <label for="filter-estado" class="form-label">
                        <i class="fas fa-map-marked-alt mr-2" aria-hidden="true"></i> Filtrar por Estado
                    </label>
                    <select id="filter-estado" class="form-select">
                        <option value="">Todos los Estados</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-comunidad" class="form-label">
                        <i class="fas fa-home mr-2" aria-hidden="true"></i> Comunidad
                    </label>
                    <select id="filter-comunidad" class="form-select">
                        <option value="">Todas las Comunidades</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-lengua" class="form-label">
                        <i class="fas fa-language mr-2" aria-hidden="true"></i> Lengua Originaria
                    </label>
                    <select id="filter-lengua" class="form-select">
                        <option value="">Todas las Lenguas</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-tecnica" class="form-label">
                        <i class="fas fa-palette mr-2" aria-hidden="true"></i> Técnica
                    </label>
                    <select id="filter-tecnica" class="form-select">
                        <option value="">Todas las Técnicas</option>
                    </select>
                </div>
            </div>

            <!-- Contador de resultados y botón de reset -->
            <div class="flex justify-between items-center mt-4">
                <p class="text-base" id="resultados-count">
                    <strong id="count-number">0</strong> artesanos encontrados
                </p>
                <button id="reset-filters" class="btn btn-ghost btn-sm" aria-label="Limpiar filtros">
                    <i class="fas fa-undo mr-2" aria-hidden="true"></i> Limpiar Filtros
                </button>
            </div>
        </div>
    </div>

    <!-- Grid de Artesanos -->
    <section class="section" id="artesanos-grid-section" aria-label="Galería de artesanos">
        <div class="container">
            <div class="artesanos-masonry" id="artesanos-grid" role="list">
                <!-- Loading spinner inicial -->
                <div class="loading-state" role="status" aria-live="polite">
                    <div class="spinner-container">
                        <div class="spinner" aria-hidden="true"></div>
                        <p>Cargando historias de nuestros artesanos...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Historias de Impacto -->
    <section class="section" style="background: var(--light);" id="historias-impacto" aria-label="Historias de impacto">
        <div class="container">
            <div class="section-header" data-aos="fade-up">
                <div class="section-badge">
                    <i class="fas fa-heart" aria-hidden="true"></i>
                    IMPACTO REAL
                </div>
                <h2 class="section-title">Historias de Transformación</h2>
                <p class="section-subtitle">
                    Testimonios reales de cómo PATAC ha cambiado vidas, preservado culturas y empoderado comunidades
                    enteras
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12" id="historias-destacadas-container" role="list">
                <!-- Se llenará dinámicamente con JS -->
                <div class="loading-state" role="status" aria-live="polite">
                    <div class="spinner" aria-hidden="true"></div>
                    <p>Cargando historias destacadas...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Final -->
    <section class="section" id="cta-final"
        style="background: linear-gradient(135deg, rgba(139, 69, 19, 0.95), rgba(199, 91, 57, 0.9)); color: var(--white);">
        <div class="container text-center">
            <div data-aos="fade-up">
                <h2 class="section-title" style="color: var(--white); margin-bottom: 2rem;">
                    Cada Compra es un Acto de Resistencia Cultural
                </h2>
                <p class="section-subtitle"
                    style="color: var(--white); opacity: 0.95; max-width: 800px; margin: 0 auto 3rem;">
                    Al apoyar a nuestros artesanos, no solo adquieres una pieza única de arte textil. Contribuyes a la
                    preservación de técnicas milenarias, al sustento digno de familias indígenas y a la transmisión de
                    conocimientos ancestrales a las nuevas generaciones.
                </p>
                <div class="btn-group justify-center">
                    <a href="proyectos.html" class="btn btn-primary btn-lg">
                        <i class="fas fa-hands-helping mr-3" aria-hidden="true"></i>
                        Apoya un Proyecto
                    </a>
                    <a href="index.html#contacto" class="btn btn-secondary btn-lg">
                        <i class="fas fa-envelope mr-3" aria-hidden="true"></i>
                        Contáctanos
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>PATAC México</h4>
                <p>Cooperativa especializada en la preservación del patrimonio biocultural textil de pueblos originarios
                    mediante incubación empresarial, educación integral y comercio justo.</p>
                <p><strong>Eslogan:</strong> "El Tejido Cultural de México"</p>
            </div>
            <div class="footer-section">
                <h4>Enlaces Rápidos</h4>
                <ul>
                    <li><a href="index.html#inicio">Inicio</a></li>
                    <li><a href="index.html#mision">Misión</a></li>
                    <li><a href="proyectos.html">Proyectos</a></li>
                    <li><a href="artesanos.html" aria-current="page">Artesanos</a></li>
                    <li><a href="index.html#contacto">Contacto</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contacto</h4>
                <p><i class="fas fa-phone mr-2" aria-hidden="true"></i> +52 55 2521 3142</p>
                <p><i class="fas fa-envelope mr-2" aria-hidden="true"></i> contacto@patac.org</p>
                <p><i class="fas fa-building mr-2" aria-hidden="true"></i> SC de RL de CV</p>
            </div>
            <div class="footer-section">
                <h4>Síguenos</h4>
                <div class="flex gap-4 mb-4 justify-center">
                    <a href="https://facebook.com/PATACMEX" class="btn btn-icon btn-secondary" target="_blank"
                        rel="noopener noreferrer" aria-label="Visita PATAC México en Facebook">
                        <i class="fab fa-facebook-f" aria-hidden="true"></i>
                    </a>
                    <a href="https://twitter.com/MexicoPatac" class="btn btn-icon btn-secondary" target="_blank"
                        rel="noopener noreferrer" aria-label="Visita PATAC México en Twitter">
                        <i class="fab fa-twitter" aria-hidden="true"></i>
                    </a>
                    <a href="https://instagram.com/patacmx" class="btn btn-icon btn-secondary" target="_blank"
                        rel="noopener noreferrer" aria-label="Visita PATAC México en Instagram">
                        <i class="fab fa-instagram" aria-hidden="true"></i>
                    </a>
                    <a href="https://linkedin.com/company/PATACMX" class="btn btn-icon btn-secondary" target="_blank"
                        rel="noopener noreferrer" aria-label="Visita PATAC México en LinkedIn">
                        <i class="fab fa-linkedin-in" aria-hidden="true"></i>
                    </a>
                </div>
                <a href="index.html#contacto" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-envelope mr-2" aria-hidden="true"></i> contacto@patac.org
                </a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 PATAC México. Todos los derechos reservados. | Fundada en 2020 como SAS de CV, evolucionó a SC de RL de CV en julio de 2023.</p>
        </div>
    </footer>

    <!-- Modal para Historia Completa -->
    <div class="modal" id="historia-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-backdrop" role="button" aria-label="Cerrar modal" tabindex="0"></div>
        <div class="modal-content-enhanced">
            <button class="modal-close-enhanced" id="modal-close" aria-label="Cerrar modal" aria-expanded="false">&times;</button>
            <div class="modal-body-scrollable" id="modal-body">
                <!-- Se llenará dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Inicializar AOS
        AOS.init({
            duration: 800,
            once: true,
            offset: 50
        });

        // API Base URL
        const API_BASE = '/api';

        // Estado global
        let todosLosArtesanos = [];
        let artesanosFiltrados = [];
        let typewriter = null;

        // ==================== MOBILE NAVIGATION ====================
        const navToggle = document.getElementById('nav-toggle');
        const navSidebar = document.getElementById('nav-sidebar');
        const navClose = document.getElementById('nav-close');
        const navOverlay = document.getElementById('nav-overlay');

        if (navToggle) {
            navToggle.addEventListener('click', () => {
                navSidebar.classList.add('active');
                navOverlay.classList.add('active');
                navToggle.classList.add('active');
                navToggle.setAttribute('aria-expanded', 'true');
            });
        }

        const closeMenu = () => {
            navSidebar.classList.remove('active');
            navOverlay.classList.remove('active');
            navToggle.classList.remove('active');
            navToggle.setAttribute('aria-expanded', 'false');
        };

        if (navClose) navClose.addEventListener('click', closeMenu);
        if (navOverlay) navOverlay.addEventListener('click', closeMenu);

        // ==================== QUICK NAVIGATION & SCROLLSPY ====================
        const quickNavLinks = document.querySelectorAll('.quick-nav-artesanos .quick-nav-link');
        const sections = document.querySelectorAll('.section');

        const onScroll = () => {
            const scrollPosition = window.scrollY + window.innerHeight / 2;
            sections.forEach(section => {
                if (scrollPosition >= section.offsetTop && scrollPosition < section.offsetTop + section.offsetHeight) {
                    quickNavLinks.forEach(link => {
                        link.classList.remove('active');
                        if (section.id && link.getAttribute('href') === `#${section.id}`) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        };

        window.addEventListener('scroll', onScroll);

        // ==================== TYPEWRITER EFFECT ====================
        function initTypewriter() {
            const messages = [
                "Tejiendo futuros dignos",
                "Preservando culturas vivas",
                "Empoderando comunidades",
                "Cada hilo, una historia",
                "Tradición que transforma vidas"
            ];

            typewriter = new Typed('#typewriter', {
                strings: messages,
                typeSpeed: 60,
                backSpeed: 40,
                backDelay: 2000,
                loop: true,
                showCursor: true,
                cursorChar: '|',
                autoInsertCss: false
            });
        }

        // ==================== SCROLL EFFECTS ====================
        let lastScrollTop = 0;
        window.addEventListener('scroll', () => {
            const nav = document.querySelector('.nav');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

            if (scrollTop > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }

            // Mostrar/ocultar filtros en scroll (solo desktop)
            if (window.innerWidth > 768) {
                const filtersContainer = document.getElementById('filters-container');
                if (scrollTop > lastScrollTop && scrollTop > 200) {
                    filtersContainer.style.transform = 'translateY(-100%)';
                    filtersContainer.style.opacity = '0';
                } else {
                    filtersContainer.style.transform = 'translateY(0)';
                    filtersContainer.style.opacity = '1';
                }
            }

            lastScrollTop = scrollTop;
        });

        // ==================== FILTROS RESPONSIVE ====================
        const toggleFiltersMobile = document.getElementById('toggle-filters-mobile');
        const filtersContainer = document.getElementById('filters-container');

        if (toggleFiltersMobile) {
            toggleFiltersMobile.addEventListener('click', () => {
                filtersContainer.classList.toggle('mobile-expanded');
                const icon = toggleFiltersMobile.querySelector('i');
                if (filtersContainer.classList.contains('mobile-expanded')) {
                    icon.classList.remove('fa-filter');
                    icon.classList.add('fa-times');
                    toggleFiltersMobile.innerHTML = '<i class="fas fa-times mr-2"></i> Ocultar Filtros';
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-filter');
                    toggleFiltersMobile.innerHTML = '<i class="fas fa-filter mr-2"></i> Mostrar Filtros';
                }
            });
        }

        // ==================== CARGAR ARTESANOS ====================
        async function cargarArtesanos() {
            try {
                const response = await fetch(`${API_BASE}/artesanos`);
                const data = await response.json();
                todosLosArtesanos = data.artesanos || [];
                artesanosFiltrados = [...todosLosArtesanos];

                // Actualizar stats del hero
                actualizarStatsHero(todosLosArtesanos);

                // Poblar filtros
                poblarFiltros(todosLosArtesanos);

                // Renderizar artesanos
                renderizarArtesanos(artesanosFiltrados);

                // Cargar historias destacadas
                cargarHistoriasDestacadas(todosLosArtesanos);

            } catch (error) {
                console.error('Error cargando artesanos:', error);
                mostrarError();
            }
        }

        // ==================== ACTUALIZAR STATS HERO ====================
        function actualizarStatsHero(artesanos) {
            const totalArtesanos = artesanos.length;
            const comunidadesUnicas = new Set(artesanos.map(a => a.comunidad)).size;
            const lenguasUnicas = new Set(artesanos.map(a => a.lenguaOriginaria).filter(Boolean)).size;

            document.getElementById('total-artesanos').textContent = totalArtesanos + '+';
            document.getElementById('total-comunidades').textContent = comunidadesUnicas + '+';
            document.getElementById('total-lenguas').textContent = lenguasUnicas + '+';
        }

        // ==================== POBLAR FILTROS ====================
        function poblarFiltros(artesanos) {
            const estados = new Set();
            const comunidades = new Set();
            const lenguas = new Set();
            const tecnicas = new Set();

            artesanos.forEach(artesano => {
                if (artesano.estado) estados.add(artesano.estado);
                if (artesano.comunidad) comunidades.add(artesano.comunidad);
                if (artesano.lenguaOriginaria) lenguas.add(artesano.lenguaOriginaria);
                if (artesano.tecnica) tecnicas.add(artesano.tecnica);
            });

            poblarSelect('filter-estado', Array.from(estados).sort());
            poblarSelect('filter-comunidad', Array.from(comunidades).sort());
            poblarSelect('filter-lengua', Array.from(lenguas).sort());
            poblarSelect('filter-tecnica', Array.from(tecnicas).sort());
        }

        function poblarSelect(id, opciones) {
            const select = document.getElementById(id);
            opciones.forEach(opcion => {
                const option = document.createElement('option');
                option.value = opcion;
                option.textContent = opcion;
                select.appendChild(option);
            });
        }

        // ==================== APLICAR FILTROS ====================
        function aplicarFiltros() {
            const estadoSeleccionado = document.getElementById('filter-estado').value;
            const comunidadSeleccionada = document.getElementById('filter-comunidad').value;
            const lenguaSeleccionada = document.getElementById('filter-lengua').value;
            const tecnicaSeleccionada = document.getElementById('filter-tecnica').value;

            artesanosFiltrados = todosLosArtesanos.filter(artesano => {
                return (!estadoSeleccionado || artesano.estado === estadoSeleccionado) &&
                    (!comunidadSeleccionada || artesano.comunidad === comunidadSeleccionada) &&
                    (!lenguaSeleccionada || artesano.lenguaOriginaria === lenguaSeleccionada) &&
                    (!tecnicaSeleccionada || artesano.tecnica === tecnicaSeleccionada);
            });

            renderizarArtesanos(artesanosFiltrados);
            document.getElementById('count-number').textContent = artesanosFiltrados.length;
        }

        // Event listeners para filtros
        ['filter-estado', 'filter-comunidad', 'filter-lengua', 'filter-tecnica'].forEach(id => {
            document.getElementById(id).addEventListener('change', aplicarFiltros);
        });

        // Reset filtros
        document.getElementById('reset-filters').addEventListener('click', () => {
            document.getElementById('filter-estado').value = '';
            document.getElementById('filter-comunidad').value = '';
            document.getElementById('filter-lengua').value = '';
            document.getElementById('filter-tecnica').value = '';
            aplicarFiltros();
        });

        // ==================== RENDERIZAR ARTESANOS ====================
        function renderizarArtesanos(artesanos) {
            const grid = document.getElementById('artesanos-grid');

            if (artesanos.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                        <i class="fas fa-search" style="font-size: 3rem; color: var(--gray-400); margin-bottom: 1rem;" aria-hidden="true"></i>
                        <h3 style="color: var(--primary); margin-bottom: 1rem;">No se encontraron artesanos</h3>
                        <p style="color: var(--gray-600);">Intenta ajustar los filtros para ver más resultados</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = artesanos.map((artesano, index) => {
                const tecnicas = artesano.tecnica ? artesano.tecnica.split(',').map(t => t.trim()) : [];
                const impactoNumerico = extraerNumeroImpacto(artesano.impactoEconomico);
                const edad = artesano.edad || 'N/A';

                return `
                    <div class="card artesano-card-enhanced" data-aos="fade-up" data-aos-delay="${Math.min(index * 50, 400)}" role="listitem">
                        <div class="artesano-avatar-cultural">
                            <img src="${artesano.urlFoto}" 
                                 alt="Foto de ${artesano.nombreCompleto}, artesano textil de ${artesano.comunidad}"
                                 loading="lazy"
                                 onerror="this.src='https://via.placeholder.com/180?text=Sin+Foto'">
                        </div>
                        
                        <div class="card-content">
                            <h3 class="card-title" style="text-align: center; margin-bottom: 0.5rem;">
                                ${artesano.nombreCompleto}
                            </h3>
                            <p class="card-category" style="text-align: center; margin-bottom: 1rem;">
                                ${edad} años
                            </p>
                            
                            <div style="text-align: center; margin-bottom: 1.5rem;">
                                <p style="margin-bottom: 0.5rem;">
                                    <i class="fas fa-map-marker-alt" style="color: var(--accent); margin-right: 0.5rem;" aria-hidden="true"></i>
                                    <strong>${artesano.comunidad}</strong>, ${artesano.estado || 'México'}
                                </p>
                                ${artesano.lenguaOriginaria ? `
                                    <p style="margin-bottom: 0;">
                                        <i class="fas fa-language" style="color: var(--gold); margin-right: 0.5rem;" aria-hidden="true"></i>
                                        ${artesano.lenguaOriginaria}
                                    </p>
                                ` : ''}
                            </div>
                            
                            <div style="text-align: center; margin-bottom: 1.5rem;">
                                ${tecnicas.map(tecnica => `
                                    <span class="tecnica-badge">
                                        <i class="fas fa-hands" aria-hidden="true"></i>
                                        ${tecnica}
                                    </span>
                                `).join('')}
                            </div>
                            
                            <p class="card-description" style="text-align: left;">
                                ${truncarTexto(artesano.historia, 120)}
                            </p>
                            
                            ${impactoNumerico ? `
                                <div class="impact-metrics">
                                    <div class="metric-item">
                                        <span class="metric-value">+${impactoNumerico}%</span>
                                        <span class="metric-label">Incremento</span>
                                    </div>
                                    ${artesano.proyectosParticipados ? `
                                        <div class="metric-item">
                                            <span class="metric-value">${artesano.proyectosParticipados}</span>
                                            <span class="metric-label">Proyectos</span>
                                        </div>
                                    ` : ''}
                                    ${artesano.aprendices ? `
                                        <div class="metric-item">
                                            <span class="metric-value">${artesano.aprendices}</span>
                                            <span class="metric-label">Aprendices</span>
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                            
                            <div class="card-footer" style="display: flex; gap: 0.75rem; margin-top: 1.5rem; flex-wrap: wrap;">
                                <button class="btn btn-primary btn-sm" onclick="verHistoriaCompleta('${artesano.idArtesano}')" style="flex: 1;" aria-label="Ver historia de ${artesano.nombreCompleto}">
                                    <i class="fas fa-book-open mr-2" aria-hidden="true"></i>
                                    Ver Historia
                                </button>
                                ${artesano.urlVideo ? `
                                    <button class="btn btn-outline btn-sm" onclick="reproducirVideo('${artesano.urlVideo}')" style="flex: 1;" aria-label="Ver video de ${artesano.nombreCompleto}">
                                        <i class="fas fa-play mr-2" aria-hidden="true"></i>
                                        Video
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Actualizar contador
            document.getElementById('count-number').textContent = artesanos.length;
        }

        // ==================== UTILIDADES ====================
        function truncarTexto(texto, maxLength) {
            if (!texto) return 'Historia no disponible.';
            if (texto.length <= maxLength) return texto;
            return texto.substring(0, maxLength) + '...';
        }

        function extraerNumeroImpacto(impactoTexto) {
            if (!impactoTexto) return null;
            const match = impactoTexto.match(/(\d+)/);
            return match ? parseInt(match[1]) : null;
        }

        // ==================== MODAL HISTORIA COMPLETA ====================
        function verHistoriaCompleta(idArtesano) {
            const artesano = todosLosArtesanos.find(a => a.idArtesano === idArtesano);
            if (!artesano) return;

            const modalBody = document.getElementById('modal-body');
            const tecnicas = artesano.tecnica ? artesano.tecnica.split(',').map(t => t.trim()) : [];

            modalBody.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <div class="artesano-avatar-cultural" style="width: 240px; height: 240px;">
                            <img src="${artesano.urlFoto}" 
                                 alt="${artesano.nombreCompleto}"
                                 onerror="this.src='https://via.placeholder.com/240?text=Sin+Foto'">
                        </div>
                        
                        <div style="margin-top: 2rem;">
                            <h3 style="font-size: 1.5rem; color: var(--primary); margin-bottom: 0.5rem;">
                                ${artesano.nombreCompleto}
                            </h3>
                            <p style="color: var(--gray-600); margin-bottom: 1.5rem;">
                                ${artesano.edad || 'N/A'} años
                            </p>
                            
                            <div style="display: grid; gap: 1rem;">
                                <div>
                                    <strong style="color: var(--primary);">
                                        <i class="fas fa-map-marker-alt mr-2" aria-hidden="true"></i>Ubicación:
                                    </strong>
                                    <p>${artesano.comunidad}, ${artesano.estado || 'México'}</p>
                                </div>
                                
                                ${artesano.lenguaOriginaria ? `
                                    <div>
                                        <strong style="color: var(--primary);">
                                            <i class="fas fa-language mr-2" aria-hidden="true"></i>Lengua Originaria:
                                        </strong>
                                        <p>${artesano.lenguaOriginaria}</p>
                                    </div>
                                ` : ''}
                                
                                <div>
                                    <strong style="color: var(--primary);">
                                        <i class="fas fa-hands mr-2" aria-hidden="true"></i>Técnicas Dominadas:
                                    </strong>
                                    <div style="margin-top: 0.5rem;">
                                        ${tecnicas.map(t => `<span class="tecnica-badge">${t}</span>`).join('')}
                                    </div>
                                </div>
                                
                                ${artesano.impactoEconomico ? `
                                    <div>
                                        <strong style="color: var(--primary);">
                                            <i class="fas fa-chart-line mr-2" aria-hidden="true"></i>Impacto:
                                        </strong>
                                        <p>${artesano.impactoEconomico}</p>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 style="font-size: 1.25rem; color: var(--primary); margin-bottom: 1rem;">
                            <i class="fas fa-book-reader mr-2" aria-hidden="true"></i>Su Historia
                        </h4>
                        <div class="historia-destacada">
                            <p style="font-size: 1.125rem; line-height: 1.8; color: var(--dark);">
                                ${artesano.historia || 'Historia no disponible.'}
                            </p>
                        </div>
                        
                        ${artesano.urlVideo ? `
                            <div style="margin-top: 2rem;">
                                <h4 style="font-size: 1.25rem; color: var(--primary); margin-bottom: 1rem;">
                                    <i class="fas fa-video mr-2" aria-hidden="true"></i>Conócelo en Video
                                </h4>
                                <div class="video-wrapper">
                                    <iframe 
                                        src="${convertirVideoUrl(artesano.urlVideo)}" 
                                        frameborder="0" 
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowfullscreen
                                        title="Video de ${artesano.nombreCompleto}">
                                    </iframe>
                                </div>
                            </div>
                        ` : ''}
                        
                        <div style="margin-top: 2rem; text-align: center;">
                            <a href="proyectos.html" class="btn btn-primary btn-lg">
                                <i class="fas fa-heart mr-2" aria-hidden="true"></i>
                                Apoya a ${artesano.nombreCompleto.split(' ')[0]}
                            </a>
                        </div>
                    </div>
                </div>
            `;

            // Mostrar modal
            const modal = document.getElementById('historia-modal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            document.getElementById('modal-close').setAttribute('aria-expanded', 'true');
        }

        function convertirVideoUrl(url) {
            // Convertir URLs de YouTube a embed
            if (url.includes('youtube.com/watch')) {
                const videoId = url.split('v=')[1]?.split('&')[0];
                return `https://www.youtube.com/embed/${videoId}`;
            }
            if (url.includes('youtu.be/')) {
                const videoId = url.split('youtu.be/')[1]?.split('?')[0];
                return `https://www.youtube.com/embed/${videoId}`;
            }
            return url;
        }

        function reproducirVideo(url) {
            verHistoriaCompleta(event.target.closest('.card').querySelector('[onclick^="verHistoriaCompleta"]').getAttribute('onclick').match(/'([^']+)'/)[1]);
        }

        // Cerrar modal
        document.getElementById('modal-close').addEventListener('click', () => {
            const modal = document.getElementById('historia-modal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            document.getElementById('modal-close').setAttribute('aria-expanded', 'false');
        });

        document.querySelector('.modal-backdrop').addEventListener('click', () => {
            const modal = document.getElementById('historia-modal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            document.getElementById('modal-close').setAttribute('aria-expanded', 'false');
        });

        // Cerrar modal con Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const modal = document.getElementById('historia-modal');
                if (modal.classList.contains('active')) {
                    modal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    document.getElementById('modal-close').setAttribute('aria-expanded', 'false');
                }
            }
        });

        // ==================== HISTORIAS DESTACADAS ====================
        function cargarHistoriasDestacadas(artesanos) {
            const container = document.getElementById('historias-destacadas-container');

            // Seleccionar artesanos con mayor impacto
            const destacados = artesanos
                .filter(a => a.impactoEconomico && a.historia)
                .sort((a, b) => {
                    const impactoA = extraerNumeroImpacto(a.impactoEconomico) || 0;
                    const impactoB = extraerNumeroImpacto(b.impactoEconomico) || 0;
                    return impactoB - impactoA;
                })
                .slice(0, 4);

            if (destacados.length === 0) {
                container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: var(--gray-600);">Próximamente más historias inspiradoras.</p>';
                return;
            }

            container.innerHTML = destacados.map((artesano, index) => {
                const impacto = extraerNumeroImpacto(artesano.impactoEconomico);
                return `
                    <div class="historia-destacada" data-aos="fade-up" data-aos-delay="${index * 100}" role="listitem">
                        <div class="flex gap-6 items-start">
                            <div style="flex-shrink: 0;">
                                <div style="width: 120px; height: 120px; border-radius: 50%; overflow: hidden; border: 4px solid var(--gold);">
                                    <img src="${artesano.urlFoto}" 
                                         alt="${artesano.nombreCompleto}"
                                         style="width: 100%; height: 100%; object-fit: cover;"
                                         onerror="this.src='https://via.placeholder.com/120?text=Sin+Foto'">
                                </div>
                            </div>
                            <div style="flex: 1;">
                                <h4 style="font-size: 1.5rem; color: var(--primary); margin-bottom: 0.5rem;">
                                    ${artesano.nombreCompleto}
                                </h4>
                                <p style="color: var(--accent); font-weight: 600; margin-bottom: 1rem;">
                                    ${artesano.comunidad}, ${artesano.estado || 'México'}
                                </p>
                                <p style="font-size: 1.125rem; line-height: 1.8; color: var(--dark); margin-bottom: 1.5rem;">
                                    ${truncarTexto(artesano.historia, 200)}
                                </p>
                                ${impacto ? `
                                    <div class="badge badge-success" style="font-size: 1rem; padding: 0.75rem 1.5rem;">
                                        <i class="fas fa-chart-line mr-2" aria-hidden="true"></i>
                                        Incrementó sus ingresos en +${impacto}%
                                    </div>
                                ` : ''}
                                <button onclick="verHistoriaCompleta('${artesano.idArtesano}')" 
                                        class="btn btn-ghost btn-sm" 
                                        style="margin-top: 1rem;" aria-label="Leer historia completa de ${artesano.nombreCompleto}">
                                    Leer historia completa →
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ==================== MOSTRAR ERROR ====================
        function mostrarError() {
            const grid = document.getElementById('artesanos-grid');
            grid.innerHTML = `
                <div class="error-message" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 1rem;" aria-hidden="true"></i>
                    <p>Error al cargar los artesanos. Por favor, intenta de nuevo.</p>
                    <button onclick="cargarArtesanos()" class="btn btn-primary btn-sm" style="margin-top: 1rem;">
                        <i class="fas fa-redo mr-2" aria-hidden="true"></i>Reintentar
                    </button>
                </div>
            `;
        }

        // ==================== SMOOTH SCROLL ====================
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href !== '#') {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
        });

        // ==================== INICIALIZACIÓN ====================
        document.addEventListener('DOMContentLoaded', () => {
            initTypewriter();
            cargarArtesanos();

            // Detectar cambio de tamaño de ventana
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    filtersContainer.classList.remove('mobile-expanded');
                    if (toggleFiltersMobile) {
                        toggleFiltersMobile.innerHTML = '<i class="fas fa-filter mr-2"></i> Mostrar Filtros';
                    }
                }
            });
        });

        // Hacer funciones globales
        window.verHistoriaCompleta = verHistoriaCompleta;
        window.reproducirVideo = reproducirVideo;
        window.cargarArtesanos = cargarArtesanos;
    </script>
</body>

</html>